<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cooperativa Pro-Vivienda mi Esperanza - Gesti√≥n de Socios</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <!-- Custom Element Styles removed in favor of css/style.css -->
</head>

<body>
    <!-- Modal de Login -->
    <div id="loginModal" class="modal" style="display: flex; z-index: 99999;">
        <div class="modal-content">
            <h2 class="modal-title">Acceso a la Aplicaci√≥n</h2>
            <div id="passwordError" class="alert alert-error" style="display: none;"></div>
            <form id="loginForm"
                onsubmit="event.preventDefault(); try{window.checkAppPassword(false);}catch(e){alert('Error: '+e.message);console.error(e);}return false;">
                <div class="form-group">
                    <label class="form-label">Contrase√±a</label>
                    <input type="password" id="appPasswordInput" placeholder="Ingresa la contrase√±a" required autofocus
                        class="form-input">
                </div>
                <div style="display: flex; gap: 0.5rem; flex-direction: column;">
                    <button type="submit" id="loginButton" class="btn btn-primary" style="width: 100%;">
                        Acceder
                    </button>
                    <button type="button" id="adminLoginButton" onclick="event.preventDefault(); try{window.checkAppPassword(true);}catch(e){alert('Error: '+e.message);console.error(e);}" class="btn btn-outline" style="width: 100%;">
                        <span class="material-icons-round" style="font-size: 1.2rem; vertical-align: middle;">admin_panel_settings</span>
                        Entrar como Administrador
                    </button>
                </div>
            </form>
            <div style="text-align: center; padding-top: 1rem; border-top: 1px solid var(--glass-border);">
                <p style="margin-bottom: 1rem; font-size: 0.85rem;">¬øNo tienes cuenta a√∫n?</p>
                <button type="button" onclick="window.location.href='registro.html'" class="btn btn-outline"
                    style="width: 100%;">
                    Registrarme
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Login Administraci√≥n -->
    <div id="adminLoginModal" class="modal hidden" style="display: none !important; z-index: 99998;">
        <div class="modal-content">
            <h2 class="modal-title">Acceso a Administraci√≥n</h2>
            <div id="adminPasswordError" class="alert alert-error" style="display: none;"></div>
            <form id="adminLoginForm"
                onsubmit="event.preventDefault(); try{window.checkAdminPassword();}catch(e){alert('Error: '+e.message);console.error(e);}return false;">
                <div class="form-group">
                    <label class="form-label">Contrase√±a</label>
                    <input type="password" id="adminPasswordInput" placeholder="Ingresa la contrase√±a de administraci√≥n"
                        required autofocus class="form-input">
                </div>
                <button type="submit" id="adminLoginButton" class="btn btn-primary" style="width: 100%;">
                    Acceder
                </button>
            </form>
        </div>
    </div>

    <!-- Contenido Principal -->
    <div id="appContent" style="display: none;">
        <!-- Navbar -->
        <nav class="navbar">
            <div class="navbar-content">
                <div class="navbar-title">
                    <span class="material-icons-round">home</span>
                    Cooperativa Pro-Vivienda mi Esperanza
                </div>
                <button id="toggleContrastBtn" class="btn btn-outline" title="Alternar modo alto contraste">
                    <span class="material-icons-round">contrast</span>
                    ALTO CONTRASTE
                </button>
            </div>
        </nav>

        <!-- Main Container -->
        <div class="main-container">
            <!-- Balance Card -->
            <!-- Stats Grid (Balance) -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Ingresos Totales</div>
                    <div id="balanceIngresos" class="stat-value" style="color: var(--status-success);">‚Ç¨0.00</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Gastos Totales</div>
                    <div id="balanceGastos" class="stat-value" style="color: var(--status-danger);">‚Ç¨0.00</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Balance Actual</div>
                    <div id="balanceActual" class="stat-value highlight">‚Ç¨0.00</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Socios Totales</div>
                    <div id="balanceSocios" class="stat-value">0</div>
                </div>
            </div>

            <!-- Tabs de Navegaci√≥n Principal -->
            <div class="tabs">
                <button class="tab-btn active" id="tabSocios"
                    onclick="if(typeof window.switchTab==='function'){window.switchTab('socios').catch(e=>{console.error('Error:',e);alert('Error al cambiar de pesta√±a. Por favor, recarga la p√°gina.');});}">
                    <span class="material-icons-round">people</span> Socios
                </button>
                <button class="tab-btn" id="tabAdmin"
                    onclick="if(typeof window.switchTab==='function'){window.switchTab('admin').catch(e=>{console.error('Error:',e);});}">
                    <span class="material-icons-round">admin_panel_settings</span> Administraci√≥n
                </button>
            </div>

            <!-- Tab: Socios -->
            <div id="panelSocios" class="tab-panel active">
                <!-- Secci√≥n QR en la esquina superior izquierda -->
                <!-- QR Code Card con Glassmorphism Elegante -->
                <div class="qr-card-container" style="position: relative; margin-bottom: 2rem;">
                    <!-- QR en la esquina superior izquierda con efecto vidrio -->
                    <div id="qrCodeContainer" class="qr-code-glass" style="position: absolute; top: 1rem; left: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(20px) saturate(180%); -webkit-backdrop-filter: blur(20px) saturate(180%); border: 1px solid rgba(255, 255, 255, 0.18); border-radius: 16px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.1) inset, 0 1px 0 rgba(255, 255, 255, 0.2) inset; z-index: 10; opacity: 0; transform: scale(0.8); transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);">
                        <div style="display: flex; align-items: center; justify-content: center; width: 150px; height: 150px; color: rgba(255, 255, 255, 0.6);">
                            <div style="text-align: center;">
                                <div class="material-icons-round" style="font-size: 32px; margin-bottom: 0.5rem; opacity: 0.7;">qr_code</div>
                                <p style="font-size: 0.75rem; font-weight: 500; letter-spacing: 0.5px;">Cargando...</p>
                            </div>
                        </div>
                    </div>
                    <!-- Mensaje principal con glassmorphism elegante -->
                    <div class="qr-message-card" style="background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(25px) saturate(180%); -webkit-backdrop-filter: blur(25px) saturate(180%); border: 1px solid rgba(255, 255, 255, 0.12); border-radius: 20px; padding: 2.5rem; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.08) inset, 0 1px 2px rgba(255, 255, 255, 0.15) inset; padding-left: 200px; min-height: 190px; position: relative; overflow: hidden;">
                        <!-- Efecto de luz sutil en el borde superior -->
                        <div style="position: absolute; top: 0; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);"></div>
                        <div style="text-align: left; position: relative; z-index: 1;">
                            <span class="material-icons-round qr-icon-elegant" style="font-size: 2.25rem; margin-bottom: 1rem; display: block; color: rgba(255, 255, 255, 0.9); opacity: 1; filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.3));">qr_code_scanner</span>
                            <p style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.75rem; line-height: 1.5; color: rgba(255, 255, 255, 0.95); letter-spacing: -0.02em; text-shadow: 0 2px 12px rgba(0, 0, 0, 0.2);">
                                Comparte el c√≥digo con alguien que quieras
                            </p>
                            <p style="font-size: 1rem; opacity: 0.85; line-height: 1.6; color: rgba(255, 255, 255, 0.8); font-weight: 400; letter-spacing: 0.01em;">
                                Todos podemos tener un techo digno y seguro
                            </p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Lista de Socios</h2>
                        <button class="btn btn-primary" id="registrarseBtn"
                            onclick="try{window.navigateTo('registro.html');}catch(e){window.location.href='registro.html';}">
                            <span class="material-icons-round">person_add</span>
                            Registrarse
                        </button>
                    </div>

                    <!-- Tabla de Socios Simplificada -->
                    <div class="table-container">
                        <table id="sociosTable">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Apellido</th>
                                    <th>Tel√©fono</th>
                                </tr>
                            </thead>
                            <tbody id="sociosTableBody">
                                <tr>
                                    <td colspan="3" class="empty-state">
                                        <div class="empty-state-icon">üìã</div>
                                        <p>No hay socios registrados</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Tab: Administraci√≥n -->
            <div id="panelAdmin" class="tab-panel hidden">
                <!-- Sub-tabs de Administraci√≥n -->
                <div class="sub-tabs">
                    <button class="sub-tab-btn" id="subTabSocios"
                        onclick="if(typeof window.switchAdminTab==='function'){window.switchAdminTab('socios').catch(e=>{console.error('Error:',e);alert('Error al cambiar de pesta√±a. Por favor, recarga la p√°gina.');});}">
                        <span class="material-icons-round">people</span> Gesti√≥n de Socios
                    </button>
                    <button class="sub-tab-btn active" id="subTabGastos"
                        onclick="if(typeof window.switchAdminTab==='function'){window.switchAdminTab('gastos').catch(e=>{console.error('Error:',e);alert('Error al cambiar de pesta√±a. Por favor, recarga la p√°gina.');});}">
                        <span class="material-icons-round">trending_down</span> Gastos
                    </button>
                    <button class="sub-tab-btn" id="subTabIngresos"
                        onclick="if(typeof window.switchAdminTab==='function'){window.switchAdminTab('ingresos').catch(e=>{console.error('Error:',e);alert('Error al cambiar de pesta√±a. Por favor, recarga la p√°gina.');});}">
                        <span class="material-icons-round">trending_up</span> Ingresos
                    </button>
                    <button class="sub-tab-btn" id="subTabAportes"
                        onclick="if(typeof window.switchAdminTab==='function'){window.switchAdminTab('aportes').catch(e=>{console.error('Error:',e);alert('Error al cambiar de pesta√±a. Por favor, recarga la p√°gina.');});}">
                        <span class="material-icons-round">calendar_month</span> Seguimiento de Aportes
                    </button>
                </div>

                <!-- Sub-tab: Gesti√≥n de Socios (Admin) -->
                <div id="sociosTab" class="sub-tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Gesti√≥n de Socios</h2>
                            <button class="btn btn-primary" id="addSocioBtn"
                                onclick="try{window.openAddModal();}catch(e){alert('Error: '+e.message);}">
                                <span class="material-icons-round">add</span>
                                Agregar Socio
                            </button>
                        </div>

                        <!-- Tabla de Socios Completa (solo en Admin) -->
                        <div class="table-container">
                            <table id="adminSociosTable">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Nombre</th>
                                        <th>Apellido</th>
                                        <th>Email</th>
                                        <th>Tel√©fono</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="adminSociosTableBody">
                                    <tr>
                                        <td colspan="7" class="empty-state">
                                            <div class="empty-state-icon">üìã</div>
                                            <p>No hay socios registrados</p>
                                            <p style="font-size: 0.875rem; margin-top: 0.5rem;">Haz clic en "Agregar
                                                Socio" para comenzar</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Sub-tab: Gastos -->
                <div id="gastosTab" class="sub-tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Gesti√≥n de Gastos</h2>
                            <button class="btn btn-primary" id="addGastoBtn"
                                onclick="try{window.openAddGastoModal();}catch(e){alert('Error: '+e.message);}">
                                <span class="material-icons-round">add</span>
                                Agregar Gasto
                            </button>
                        </div>
                        <div class="table-container">
                            <table id="gastosTable">
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Concepto</th>
                                        <th>Monto</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="gastosTableBody">
                                    <tr>
                                        <td colspan="4" class="empty-state">
                                            <div class="empty-state-icon">üí∞</div>
                                            <p>No hay gastos registrados</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Sub-tab: Ingresos -->
                <div id="ingresosTab" class="sub-tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Gesti√≥n de Ingresos</h2>
                            <button class="btn btn-primary" id="addIngresoBtn"
                                onclick="try{window.openAddIngresoModal();}catch(e){alert('Error: '+e.message);}">
                                <span class="material-icons-round">add</span>
                                Agregar Ingreso
                            </button>
                        </div>
                        <div class="table-container">
                            <table id="ingresosTable">
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Concepto</th>
                                        <th>Monto</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="ingresosTableBody">
                                    <tr>
                                        <td colspan="4" class="empty-state">
                                            <div class="empty-state-icon">üíµ</div>
                                            <p>No hay ingresos registrados</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Sub-tab: Seguimiento de Aportes -->
                <div id="aportesTab" class="sub-tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Seguimiento de Aportes Mensuales</h2>
                            <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                                <div style="display: flex; gap: 0.5rem; align-items: center;">
                                    <label class="form-label" style="margin: 0;">Mes/A√±o:</label>
                                    <select id="mesAporteSelector" class="form-select" style="width: auto;"
                                        onchange="if(typeof window.renderAportesTable==='function'){window.renderAportesTable().catch(e=>{console.error('Error:',e);alert('Error al cargar aportes.');});}">
                                        <!-- Se llenar√° din√°micamente -->
                                    </select>
                                </div>
                                <div style="display: flex; gap: 0.5rem; align-items: center;">
                                    <label class="form-label" style="margin: 0;">Filtro:</label>
                                    <select id="filtroAportesSelector" class="form-select" style="width: auto;"
                                        onchange="if(typeof window.renderAportesTable==='function'){window.renderAportesTable().catch(e=>{console.error('Error:',e);alert('Error al cargar aportes.');});}">
                                        <option value="todos">Todos</option>
                                        <option value="pagados">Ya Pagados</option>
                                        <option value="pendientes">Falta por Pagar</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Resumen de Aportes -->
                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; padding: 1rem; background: #f3f4f6; border-radius: 8px;">
                            <div>
                                <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem;">Total Esperado
                                </div>
                                <div id="totalEsperadoAportes"
                                    style="font-size: 1.5rem; font-weight: 700; color: #2563eb;">‚Ç¨0.00</div>
                            </div>
                            <div>
                                <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem;">Total Pagado
                                </div>
                                <div id="totalPagadoAportes"
                                    style="font-size: 1.5rem; font-weight: 700; color: #10b981;">‚Ç¨0.00</div>
                            </div>
                            <div>
                                <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem;">Total
                                    Pendiente</div>
                                <div id="totalPendienteAportes"
                                    style="font-size: 1.5rem; font-weight: 700; color: #ef4444;">‚Ç¨0.00</div>
                            </div>
                            <div>
                                <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem;">Porcentaje
                                    Pagado</div>
                                <div id="porcentajePagadoAportes"
                                    style="font-size: 1.5rem; font-weight: 700; color: #6366f1;">0%</div>
                            </div>
                        </div>

                        <div class="table-container">
                            <table id="aportesTable">
                                <thead>
                                    <tr>
                                        <th>Socio</th>
                                        <th>Tel√©fono</th>
                                        <th>Cuota Mensual</th>
                                        <th>Estado</th>
                                        <th>Fecha de Pago</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="aportesTableBody">
                                    <tr>
                                        <td colspan="6" class="empty-state">
                                            <div class="empty-state-icon">üìÖ</div>
                                            <p>Cargando seguimiento de aportes...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal: Agregar/Editar Socio -->
        <div id="socioModal" class="modal hidden">
            <div class="modal-content modal-lg">
                <div class="modal-header">
                    <h2 id="modalTitle" class="modal-title">Agregar Socio</h2>
                    <button type="button" class="btn-close" onclick="closeModal()">√ó</button>
                </div>

                <form id="socioForm">
                    <!-- 1. Identificaci√≥n b√°sica de todos los integrantes de la familia -->
                    <h3
                        style="margin-top: 1rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                        1. Identificaci√≥n de los Integrantes de la Familia
                    </h3>

                    <div class="form-group">
                        <label class="form-label required">N√∫mero de miembros de la familia</label>
                        <input type="number" id="modalNumMiembros" class="form-input" min="1" value="1" required>
                        <small class="form-help">Incluy√©ndote a ti</small>
                    </div>

                    <div id="modalMiembrosContainer"></div>

                    <!-- 2. Datos de contacto -->
                    <h3
                        style="margin-top: 2rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                        2. Datos de Contacto
                    </h3>

                    <div class="form-group">
                        <label class="form-label required">Tel√©fono</label>
                        <input type="tel" id="modalTelefono" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label required">Correo electr√≥nico</label>
                        <input type="email" id="modalEmail" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Contacto de emergencia (opcional)</label>
                        <input type="text" id="modalContactoEmergencia" class="form-input"
                            placeholder="Nombre y tel√©fono">
                        <small class="form-help">Nombre completo y n√∫mero de tel√©fono de una persona de contacto en caso
                            de emergencia</small>
                    </div>

                    <!-- 3. Situaci√≥n del socio en la cooperativa -->
                    <h3
                        style="margin-top: 2rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                        3. Situaci√≥n del Socio en la Cooperativa
                    </h3>

                    <div class="form-group">
                        <label class="form-label required">Fecha de ingreso</label>
                        <input type="date" id="modalFechaIngreso" class="form-input" required>
                        <small class="form-help">Fecha en que te unes a la cooperativa</small>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Estado</label>
                        <select id="modalEstado" class="form-select" required>
                            <option value="Activo">Activo</option>
                            <option value="Inactivo">Inactivo</option>
                        </select>
                    </div>

                    <!-- 4. Aportaciones y obligaciones -->
                    <h3
                        style="margin-top: 2rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                        4. Aportaciones y Obligaciones
                    </h3>

                    <div class="form-group">
                        <label class="form-label required">Cuota mensual (‚Ç¨)</label>
                        <input type="number" id="modalCuotaMensual" class="form-input" min="0" step="0.01" value="5"
                            required>
                        <small class="form-help">Aporte mensual a la cooperativa (ejemplo: 5 ‚Ç¨)</small>
                    </div>

                    <!-- 5. Autorizaciones legales -->
                    <h3
                        style="margin-top: 2rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                        5. Autorizaciones Legales
                    </h3>

                    <div class="form-group">
                        <label style="display: flex; align-items: start; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="modalConsentimientoDatos" class="form-checkbox" required>
                            <span class="form-label">Consentimiento para uso interno de datos</span>
                        </label>
                        <small class="form-help">Acepto que mis datos sean utilizados √∫nicamente para fines internos de
                            la cooperativa, cumpliendo con la normativa de protecci√≥n de datos.</small>
                    </div>

                    <div class="form-group">
                        <label style="display: flex; align-items: start; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="modalAceptacionNormas" class="form-checkbox" required>
                            <span class="form-label">Aceptaci√≥n de normas internas y r√©gimen disciplinario</span>
                        </label>
                        <small class="form-help">Acepto las normas internas de la cooperativa y el r√©gimen disciplinario
                            establecido.</small>
                    </div>

                    <!-- 6. Participaci√≥n y disponibilidad -->
                    <h3
                        style="margin-top: 2rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                        6. Participaci√≥n y Disponibilidad
                    </h3>

                    <div class="form-group">
                        <label class="form-label">√Åreas donde desea colaborar</label>
                        <select id="modalAreasColaboracion" class="form-select" multiple style="min-height: 100px;">
                            <option value="administracion">Administraci√≥n</option>
                            <option value="eventos">Eventos</option>
                            <option value="apoyo_social">Apoyo Social</option>
                            <option value="comunicacion">Comunicaci√≥n</option>
                            <option value="finanzas">Finanzas</option>
                            <option value="proyectos">Proyectos</option>
                        </select>
                        <small class="form-help">Mant√©n presionada la tecla Ctrl (Cmd en Mac) para seleccionar m√∫ltiples
                            opciones</small>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Otras √°reas (especificar)</label>
                        <input type="text" id="modalOtrasAreas" class="form-input"
                            placeholder="Especifica otras √°reas donde te gustar√≠a colaborar">
                    </div>

                    <div class="form-group">
                        <label class="form-label required">Disponibilidad aproximada</label>
                        <input type="number" id="modalDisponibilidadHoras" class="form-input" min="0" step="1" value="0"
                            required>
                        <small class="form-help">Horas por mes que puedes dedicar a la cooperativa</small>
                    </div>

                    <!-- 7. Observaciones -->
                    <h3
                        style="margin-top: 2rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                        7. Observaciones (Opcional)
                    </h3>

                    <div class="form-group">
                        <label class="form-label">Observaciones adicionales</label>
                        <textarea id="modalObservaciones" class="form-input" rows="4"
                            placeholder="Escribe aqu√≠ cualquier informaci√≥n adicional que consideres relevante..."></textarea>
                        <small class="form-help">Informaci√≥n adicional, comentarios o cualquier dato que quieras
                            compartir con la cooperativa</small>
                    </div>

                    <div class="form-actions" style="margin-top: 2rem;">
                        <button type="submit" class="btn btn-primary" id="submitSocioBtn">Guardar</button>
                        <button type="button" class="btn btn-outline" id="cancelModalBtn">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Ver Detalles Completos del Socio -->
        <div id="socioDetallesModal" class="modal hidden">
            <div class="modal-content modal-lg">
                <div class="modal-header">
                    <h2 class="modal-title">Detalles del Socio</h2>
                    <button type="button" class="btn-close" onclick="window.closeSocioDetallesModal();">√ó</button>
                </div>
                <div id="socioDetallesContent" style="padding: 1.5rem;">
                    <!-- Contenido se llenar√° din√°micamente -->
                </div>
            </div>
        </div>

        <!-- Modal: Agregar/Editar Gasto -->
        <div id="gastoModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="gastoModalTitle" class="modal-title">Agregar Gasto</h2>
                    <button type="button" class="btn-close" onclick="closeGastoModal()">√ó</button>
                </div>

                <form id="gastoForm">
                    <div class="form-group">
                        <label class="form-label">Fecha</label>
                        <input type="date" id="gastoFecha" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Concepto</label>
                        <input type="text" id="gastoConcepto" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Monto (‚Ç¨)</label>
                        <input type="number" id="gastoMonto" class="form-input" min="0" step="0.01" required>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Guardar</button>
                        <button type="button" class="btn btn-outline" onclick="closeGastoModal()">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Agregar/Editar Ingreso -->
        <div id="ingresoModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="ingresoModalTitle" class="modal-title">Agregar Ingreso</h2>
                    <button type="button" class="btn-close" onclick="closeIngresoModal()">√ó</button>
                </div>

                <form id="ingresoForm">
                    <div class="form-group">
                        <label class="form-label">Tipo de Ingreso</label>
                        <select id="ingresoTipo" class="form-select" required
                            onchange="if(typeof window.handleCambioTipoIngreso==='function'){window.handleCambioTipoIngreso();}">
                            <option value="otro">Otro Ingreso</option>
                            <option value="aporte_socio">Aporte de Socio</option>
                        </select>
                    </div>

                    <div class="form-group" id="ingresoSocioGroup" style="display: none;">
                        <label class="form-label">Socio</label>
                        <select id="ingresoSocioId" class="form-select">
                            <option value="">-- Seleccione un socio --</option>
                        </select>
                        <small class="form-help">Al seleccionar un socio, el concepto y monto se llenar√°n
                            autom√°ticamente con su cuota mensual</small>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Fecha</label>
                        <input type="date" id="ingresoFecha" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Concepto</label>
                        <input type="text" id="ingresoConcepto" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Monto (‚Ç¨)</label>
                        <input type="number" id="ingresoMonto" class="form-input" min="0" step="0.01" required>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Guardar</button>
                        <button type="button" class="btn btn-outline" onclick="closeIngresoModal()">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Agregar/Editar Pago -->
        <div id="pagoModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="pagoModalTitle" class="modal-title">Registrar Pago</h2>
                    <button type="button" class="btn-close" onclick="closePagoModal()">√ó</button>
                </div>

                <form id="pagoForm">
                    <div class="form-group">
                        <label class="form-label">Socio</label>
                        <select id="pagoSocioId" class="form-select" required>
                            <option value="">-- Seleccione un socio --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Fecha</label>
                        <input type="date" id="pagoFecha" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Monto (‚Ç¨)</label>
                        <input type="number" id="pagoMonto" class="form-input" min="0" step="0.01" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Concepto</label>
                        <input type="text" id="pagoConcepto" class="form-input" required>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Guardar</button>
                        <button type="button" class="btn btn-outline" onclick="closePagoModal()">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>Cooperativa Pro-Vivienda mi Esperanza - Versi√≥n 1.0.0</p>
        </footer>

        <!-- Firma del Creador -->
        <!-- Firma del Creador -->
        <div class="creator-signature">
            <div style="margin-bottom: 2px;">
                creado por <span style="font-weight: 600;">Alexander Acero</span>
            </div>
            <div>
                <a href="tel:+34642868261">
                    642 868 261
                </a>
            </div>
        </div>

        <!-- Scripts -->
        <!-- Script de respaldo para capturar errores -->
        <script>
            // Asegurar que la funci√≥n de verificaci√≥n est√© disponible
            window.addEventListener('DOMContentLoaded', function () {
                console.log('üìÑ DOM cargado, verificando funci√≥n de acceso...');
                if (typeof window.checkAppPassword === 'function') {
                    console.log('‚úÖ Funci√≥n checkAppPassword disponible');
                } else {
                    console.warn('‚ö†Ô∏è Funci√≥n checkAppPassword no disponible a√∫n');
                }
            });

            // Capturar errores de JavaScript globalmente
            window.addEventListener('error', function (e) {
                console.error('Error global capturado:', e.error);
                console.error('En:', e.filename, 'l√≠nea', e.lineno);
            });

            // Capturar errores de promesas rechazadas
            window.addEventListener('unhandledrejection', function (e) {
                console.error('Promesa rechazada sin manejar:', e.reason);
            });

            console.log('‚úÖ Script de respaldo cargado');

            // Verificar carga de scripts despu√©s de un delay
            window.addEventListener('load', function () {
                setTimeout(function () {
                    console.log('üîç Verificando funciones disponibles...');
                    const functions = [
                        'openAddModal',
                        'openAddGastoModal',
                        'openAddIngresoModal',
                        'openAddPagoModal',
                        'switchTab',
                        'switchAdminTab'
                    ];

                    functions.forEach(function (fnName) {
                        if (typeof window[fnName] === 'function') {
                            console.log('‚úÖ ' + fnName + ' est√° disponible');
                        } else {
                            console.error('‚ùå ' + fnName + ' NO est√° disponible');
                        }
                    });
                }, 1000);
            });
        </script>

        <!-- Scripts en orden: primero db.js, luego admin-panel.js, finalmente main.js -->
        <script src="js/database.js"></script>
        <script src="js/db.js"></script>
        <script src="js/admin-panel.js"></script>
        <script src="js/main.js"></script>

        <!-- Script para generar QR cuando la p√°gina est√© lista -->
        <script>
            window.addEventListener('load', function () {
                setTimeout(function () {
                    if (typeof window.generateQRCode === 'function') {
                        window.generateQRCode();
                    }
                }, 500);
            });
        </script>

        <!-- Script de verificaci√≥n final y reconexi√≥n forzada -->
        <script>
            // Funci√≥n para reconectar todos los botones
            function reconectarBotones() {
                console.log('üîß Reconectando botones...');

                // Bot√≥n Agregar Socio
                const addSocioBtn = document.getElementById('addSocioBtn');
                if (addSocioBtn) {
                    // Remover listeners anteriores
                    addSocioBtn.onclick = null;
                    const newBtn = addSocioBtn.cloneNode(true);
                    addSocioBtn.parentNode.replaceChild(newBtn, addSocioBtn);

                    // Agregar nuevo listener
                    document.getElementById('addSocioBtn').addEventListener('click', function (e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('üîµ Click detectado en Agregar Socio');
                        if (typeof window.openAddModal === 'function') {
                            window.openAddModal();
                        } else {
                            alert('Funci√≥n no disponible. Por favor recarga la p√°gina.');
                        }
                    });
                    console.log('‚úÖ Bot√≥n Agregar Socio reconectado');
                }

                // Bot√≥n Agregar Gasto
                const addGastoBtn = document.getElementById('addGastoBtn');
                if (addGastoBtn) {
                    addGastoBtn.onclick = null;
                    addGastoBtn.addEventListener('click', function (e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('üîµ Click detectado en Agregar Gasto');
                        if (typeof window.openAddGastoModal === 'function') {
                            window.openAddGastoModal();
                        } else {
                            alert('Funci√≥n no disponible. Por favor recarga la p√°gina.');
                        }
                    });
                    console.log('‚úÖ Bot√≥n Agregar Gasto reconectado');
                }

                // Bot√≥n Agregar Ingreso
                const addIngresoBtn = document.getElementById('addIngresoBtn');
                if (addIngresoBtn) {
                    addIngresoBtn.onclick = null;
                    addIngresoBtn.addEventListener('click', function (e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('üîµ Click detectado en Agregar Ingreso');
                        if (typeof window.openAddIngresoModal === 'function') {
                            window.openAddIngresoModal();
                        } else {
                            alert('Funci√≥n no disponible. Por favor recarga la p√°gina.');
                        }
                    });
                    console.log('‚úÖ Bot√≥n Agregar Ingreso reconectado');
                }

                // Bot√≥n Registrar Pago
                const addPagoBtn = document.getElementById('addPagoBtn');
                if (addPagoBtn) {
                    addPagoBtn.onclick = null;
                    addPagoBtn.addEventListener('click', function (e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('üîµ Click detectado en Registrar Pago');
                        if (typeof window.openAddPagoModal === 'function') {
                            window.openAddPagoModal();
                        } else {
                            alert('Funci√≥n no disponible. Por favor recarga la p√°gina.');
                        }
                    });
                    console.log('‚úÖ Bot√≥n Registrar Pago reconectado');
                }

                // Botones de tabs
                const tabSocios = document.getElementById('tabSocios');
                if (tabSocios) {
                    tabSocios.onclick = null;
                    tabSocios.addEventListener('click', function (e) {
                        e.preventDefault();
                        if (typeof window.switchTab === 'function') {
                            window.switchTab('socios');
                        }
                    });
                }

                const tabAdmin = document.getElementById('tabAdmin');
                if (tabAdmin) {
                    tabAdmin.onclick = null;
                    tabAdmin.addEventListener('click', function (e) {
                        e.preventDefault();
                        // El switchTab ya verifica la autenticaci√≥n
                        if (typeof window.switchTab === 'function') {
                            window.switchTab('admin').catch(err => console.error('Error:', err));
                        }
                    });
                }

                // Configurar event listeners para el modal de administraci√≥n
                const adminPasswordInput = document.getElementById('adminPasswordInput');
                const adminLoginButton = document.getElementById('adminLoginButton');
                const adminLoginForm = document.getElementById('adminLoginForm');

                if (adminPasswordInput) {
                    adminPasswordInput.addEventListener('keypress', function (e) {
                        if (e.key === 'Enter') {
                            e.preventDefault();
                            if (typeof window.checkAdminPassword === 'function') {
                                window.checkAdminPassword();
                            }
                        }
                    });
                }

                if (adminLoginButton) {
                    adminLoginButton.addEventListener('click', function (e) {
                        e.preventDefault();
                        e.stopPropagation();
                        if (typeof window.checkAdminPassword === 'function') {
                            window.checkAdminPassword();
                        }
                        return false;
                    });
                }

                if (adminLoginForm) {
                    adminLoginForm.addEventListener('submit', function (e) {
                        e.preventDefault();
                        e.stopPropagation();
                        if (typeof window.checkAdminPassword === 'function') {
                            window.checkAdminPassword();
                        }
                        return false;
                    });
                }
            }

            // Ejecutar cuando la p√°gina cargue completamente
            window.addEventListener('load', function () {
                console.log('üìÑ P√°gina completamente cargada');

                // Esperar un poco para que todos los scripts carguen
                setTimeout(function () {
                    console.log('üîç Verificando funciones disponibles...');
                    const functions = [
                        'openAddModal',
                        'openAddGastoModal',
                        'openAddIngresoModal',
                        'openAddPagoModal',
                        'switchTab',
                        'switchAdminTab'
                    ];

                    functions.forEach(function (fnName) {
                        if (typeof window[fnName] === 'function') {
                            console.log('‚úÖ ' + fnName + ' est√° disponible');
                        } else {
                            console.error('‚ùå ' + fnName + ' NO est√° disponible');
                        }
                    });

                    // Reconectar botones despu√©s de verificar
                    reconectarBotones();

                    // Actualizar balance y conteo de socios
                    if (typeof window.updateBalanceDisplay === 'function') {
                        window.updateBalanceDisplay().catch(err => console.error('Error actualizando balance:', err));
                    }
                }, 500);
            });
        </script>
    </div>
    <!-- Fin del contenido principal -->
    </div>
    <!-- Fin appContent -->
</body>

</html>