<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cooperativa ProVivienda - Gesti√≥n de Socios</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 0;
        }

        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navbar-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2563eb;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid #e5e7eb;
        }

        .tab-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            background: transparent;
            color: #6b7280;
            font-weight: 500;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-btn:hover {
            color: #2563eb;
        }

        .tab-btn.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        .tab-panel.hidden {
            display: none !important;
        }

        .sub-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .sub-tab-btn {
            padding: 0.5rem 1rem;
            border: none;
            background: #f3f4f6;
            color: #374151;
            font-weight: 500;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .sub-tab-btn:hover {
            background: #e5e7eb;
        }

        .sub-tab-btn.active {
            background: #2563eb;
            color: white;
        }

        .sub-tab-content {
            display: none;
        }

        .sub-tab-content.active {
            display: block;
        }

        .main-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e5e7eb;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
        }

        .btn-primary {
            background: #2563eb;
            color: white;
        }

        .btn-primary:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
        }

        .btn-secondary {
            background: #10b981;
            color: white;
        }

        .btn-secondary:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .btn-outline {
            background: transparent;
            color: #2563eb;
            border: 2px solid #2563eb;
        }

        .btn-outline:hover {
            background: #2563eb;
            color: white;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        thead {
            background: #f3f4f6;
        }

        th {
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
            color: #4b5563;
        }

        tbody tr {
            transition: background 0.2s ease;
        }

        tbody tr:hover {
            background: #f9fafb;
        }

        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .badge-active {
            background: #d1fae5;
            color: #065f46;
        }

        .badge-inactive {
            background: #fee2e2;
            color: #991b1b;
        }

        .actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-icon {
            padding: 0.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-icon-edit {
            background: #dbeafe;
            color: #2563eb;
        }

        .btn-icon-edit:hover {
            background: #2563eb;
            color: white;
        }

        .btn-icon-delete {
            background: #fee2e2;
            color: #ef4444;
        }

        .btn-icon-delete:hover {
            background: #ef4444;
            color: white;
        }

        .btn-icon-view {
            background: #e0e7ff;
            color: #6366f1;
        }

        .btn-icon-view:hover {
            background: #6366f1;
            color: white;
        }

        .hidden {
            display: none !important;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(0, 0, 0, 0.4);
            z-index: 2000;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e5e7eb;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
        }

        .btn-close {
            background: transparent;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280;
            padding: 0.25rem;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .btn-close:hover {
            background: #f3f4f6;
            color: #1f2937;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #374151;
        }

        .form-input,
        .form-select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.2s ease;
        }

        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: #2563eb;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #6b7280;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .footer {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            text-align: center;
            color: #6b7280;
            margin-top: 2rem;
        }

        @media (max-width: 768px) {
            .navbar-content {
                flex-direction: column;
                gap: 1rem;
            }

            .main-container {
                margin: 1rem auto;
                padding: 0 0.5rem;
            }

            .card {
                padding: 1rem;
            }

            table {
                font-size: 0.875rem;
            }

            th, td {
                padding: 0.5rem;
            }

            .actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-content">
            <div class="navbar-title">
                <span class="material-icons-round">volunteer_activism</span>
                Cooperativa ProVivienda
      </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Balance Card -->
        <div class="card" style="margin-bottom: 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1.5rem; text-align: center;">
                <div>
                    <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 0.5rem;">Ingresos Totales</div>
                    <div id="balanceIngresos" style="font-size: 2rem; font-weight: 700;">‚Ç¨0.00</div>
                </div>
                <div>
                    <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 0.5rem;">Gastos Totales</div>
                    <div id="balanceGastos" style="font-size: 2rem; font-weight: 700;">‚Ç¨0.00</div>
                </div>
                <div>
                    <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 0.5rem;">Balance Actual</div>
                    <div id="balanceActual" style="font-size: 2rem; font-weight: 700;">‚Ç¨0.00</div>
                </div>
                <div>
                    <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 0.5rem;">Socios Totales</div>
                    <div id="balanceSocios" style="font-size: 2rem; font-weight: 700;">0</div>
                </div>
            </div>
        </div>

        <!-- Tabs de Navegaci√≥n Principal -->
        <div class="tabs">
            <button class="tab-btn active" id="tabSocios" onclick="if(typeof window.switchTab==='function'){window.switchTab('socios').catch(e=>{console.error('Error:',e);alert('Error al cambiar de pesta√±a. Por favor, recarga la p√°gina.');});}">
                <span class="material-icons-round">people</span> Socios
            </button>
            <button class="tab-btn" id="tabAdmin" onclick="if(typeof window.switchTab==='function'){window.switchTab('admin').catch(e=>{console.error('Error:',e);alert('Error al cambiar de pesta√±a. Por favor, recarga la p√°gina.');});}">
                <span class="material-icons-round">admin_panel_settings</span> Administraci√≥n
            </button>
        </div>

        <!-- Tab: Socios -->
        <div id="panelSocios" class="tab-panel active">
            <!-- Secci√≥n QR en la esquina superior izquierda -->
            <div style="position: relative; margin-bottom: 2rem;">
                <!-- QR en la esquina superior izquierda -->
                <div id="qrCodeContainer" style="position: absolute; top: 1rem; left: 1rem; padding: 0.5rem; background: white; border-radius: 12px; box-shadow: 0 4px 16px rgba(0,0,0,0.25); z-index: 10;">
                    <div style="display: flex; align-items: center; justify-content: center; width: 150px; height: 150px; color: #9ca3af;">
                        <div style="text-align: center;">
                            <div class="material-icons-round" style="font-size: 32px; margin-bottom: 0.5rem;">qr_code</div>
                            <p style="font-size: 0.7rem;">Cargando...</p>
                        </div>
                    </div>
                </div>
                <!-- Mensaje principal con padding para no quedar atr√°s del QR -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 16px; padding: 2rem; color: white; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); padding-left: 180px; min-height: 170px;">
                    <div style="text-align: left;">
                        <span class="material-icons-round" style="font-size: 2rem; margin-bottom: 0.75rem; display: block; opacity: 0.95;">qr_code_scanner</span>
                        <p style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; line-height: 1.6;">
                            Comparte el c√≥digo con alguien que quieras
                        </p>
                        <p style="font-size: 0.95rem; opacity: 0.9; line-height: 1.5;">
                            Todos podemos tener un techo digno y seguro
                        </p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Lista de Socios</h2>
                    <button class="btn btn-primary" id="registrarseBtn" onclick="try{window.navigateTo('registro.html');}catch(e){window.location.href='registro.html';}">
                        <span class="material-icons-round">person_add</span>
                        Registrarse
                    </button>
                </div>

                <!-- Tabla de Socios Simplificada -->
                <div class="table-container">
                    <table id="sociosTable">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Apellido</th>
                                <th>Tel√©fono</th>
                            </tr>
                        </thead>
                        <tbody id="sociosTableBody">
                            <tr>
                                <td colspan="3" class="empty-state">
                                    <div class="empty-state-icon">üìã</div>
                                    <p>No hay socios registrados</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Tab: Administraci√≥n -->
        <div id="panelAdmin" class="tab-panel hidden">
            <!-- Sub-tabs de Administraci√≥n -->
            <div class="sub-tabs">
                <button class="sub-tab-btn" id="subTabSocios" onclick="if(typeof window.switchAdminTab==='function'){window.switchAdminTab('socios').catch(e=>{console.error('Error:',e);alert('Error al cambiar de pesta√±a. Por favor, recarga la p√°gina.');});}">
                    <span class="material-icons-round">people</span> Gesti√≥n de Socios
                </button>
                <button class="sub-tab-btn active" id="subTabGastos" onclick="if(typeof window.switchAdminTab==='function'){window.switchAdminTab('gastos').catch(e=>{console.error('Error:',e);alert('Error al cambiar de pesta√±a. Por favor, recarga la p√°gina.');});}">
                    <span class="material-icons-round">trending_down</span> Gastos
                </button>
                <button class="sub-tab-btn" id="subTabIngresos" onclick="if(typeof window.switchAdminTab==='function'){window.switchAdminTab('ingresos').catch(e=>{console.error('Error:',e);alert('Error al cambiar de pesta√±a. Por favor, recarga la p√°gina.');});}">
                    <span class="material-icons-round">trending_up</span> Ingresos
                </button>
                <button class="sub-tab-btn" id="subTabAportes" onclick="if(typeof window.switchAdminTab==='function'){window.switchAdminTab('aportes').catch(e=>{console.error('Error:',e);alert('Error al cambiar de pesta√±a. Por favor, recarga la p√°gina.');});}">
                    <span class="material-icons-round">calendar_month</span> Seguimiento de Aportes
                </button>
            </div>

            <!-- Sub-tab: Gesti√≥n de Socios (Admin) -->
            <div id="sociosTab" class="sub-tab-content">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Gesti√≥n de Socios</h2>
                        <button class="btn btn-primary" id="addSocioBtn" onclick="try{window.openAddModal();}catch(e){alert('Error: '+e.message);}">
                            <span class="material-icons-round">add</span>
                            Agregar Socio
                        </button>
                    </div>

                    <!-- Tabla de Socios Completa (solo en Admin) -->
                    <div class="table-container">
                        <table id="adminSociosTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nombre</th>
                                    <th>Apellido</th>
                                    <th>Email</th>
                                    <th>Tel√©fono</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="adminSociosTableBody">
                                <tr>
                                    <td colspan="7" class="empty-state">
                                        <div class="empty-state-icon">üìã</div>
                                        <p>No hay socios registrados</p>
                                        <p style="font-size: 0.875rem; margin-top: 0.5rem;">Haz clic en "Agregar Socio" para comenzar</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Sub-tab: Gastos -->
            <div id="gastosTab" class="sub-tab-content">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Gesti√≥n de Gastos</h2>
                        <button class="btn btn-primary" id="addGastoBtn" onclick="try{window.openAddGastoModal();}catch(e){alert('Error: '+e.message);}">
                            <span class="material-icons-round">add</span>
                            Agregar Gasto
                        </button>
                    </div>
                    <div class="table-container">
                        <table id="gastosTable">
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Concepto</th>
                                    <th>Monto</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="gastosTableBody">
                                <tr>
                                    <td colspan="4" class="empty-state">
                                        <div class="empty-state-icon">üí∞</div>
                                        <p>No hay gastos registrados</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Sub-tab: Ingresos -->
            <div id="ingresosTab" class="sub-tab-content">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Gesti√≥n de Ingresos</h2>
                        <button class="btn btn-primary" id="addIngresoBtn" onclick="try{window.openAddIngresoModal();}catch(e){alert('Error: '+e.message);}">
                            <span class="material-icons-round">add</span>
                            Agregar Ingreso
                        </button>
                    </div>
                    <div class="table-container">
                        <table id="ingresosTable">
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Concepto</th>
                                    <th>Monto</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="ingresosTableBody">
                                <tr>
                                    <td colspan="4" class="empty-state">
                                        <div class="empty-state-icon">üíµ</div>
                                        <p>No hay ingresos registrados</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Sub-tab: Seguimiento de Aportes -->
            <div id="aportesTab" class="sub-tab-content">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Seguimiento de Aportes Mensuales</h2>
                        <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                            <div style="display: flex; gap: 0.5rem; align-items: center;">
                                <label class="form-label" style="margin: 0;">Mes/A√±o:</label>
                                <select id="mesAporteSelector" class="form-select" style="width: auto;" onchange="if(typeof window.renderAportesTable==='function'){window.renderAportesTable().catch(e=>{console.error('Error:',e);alert('Error al cargar aportes.');});}">
                                    <!-- Se llenar√° din√°micamente -->
                                </select>
                            </div>
                            <div style="display: flex; gap: 0.5rem; align-items: center;">
                                <label class="form-label" style="margin: 0;">Filtro:</label>
                                <select id="filtroAportesSelector" class="form-select" style="width: auto;" onchange="if(typeof window.renderAportesTable==='function'){window.renderAportesTable().catch(e=>{console.error('Error:',e);alert('Error al cargar aportes.');});}">
                                    <option value="todos">Todos</option>
                                    <option value="pagados">Ya Pagados</option>
                                    <option value="pendientes">Falta por Pagar</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Resumen de Aportes -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; padding: 1rem; background: #f3f4f6; border-radius: 8px;">
                        <div>
                            <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem;">Total Esperado</div>
                            <div id="totalEsperadoAportes" style="font-size: 1.5rem; font-weight: 700; color: #2563eb;">‚Ç¨0.00</div>
                        </div>
                        <div>
                            <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem;">Total Pagado</div>
                            <div id="totalPagadoAportes" style="font-size: 1.5rem; font-weight: 700; color: #10b981;">‚Ç¨0.00</div>
                        </div>
                        <div>
                            <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem;">Total Pendiente</div>
                            <div id="totalPendienteAportes" style="font-size: 1.5rem; font-weight: 700; color: #ef4444;">‚Ç¨0.00</div>
                        </div>
                        <div>
                            <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem;">Porcentaje Pagado</div>
                            <div id="porcentajePagadoAportes" style="font-size: 1.5rem; font-weight: 700; color: #6366f1;">0%</div>
                        </div>
                    </div>

                    <div class="table-container">
                        <table id="aportesTable">
                            <thead>
                                <tr>
                                    <th>Socio</th>
                                    <th>Tel√©fono</th>
                                    <th>Cuota Mensual</th>
                                    <th>Estado</th>
                                    <th>Fecha de Pago</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="aportesTableBody">
                                <tr>
                                    <td colspan="6" class="empty-state">
                                        <div class="empty-state-icon">üìÖ</div>
                                        <p>Cargando seguimiento de aportes...</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Agregar/Editar Socio -->
    <div id="socioModal" class="modal hidden">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 id="modalTitle" class="modal-title">Agregar Socio</h2>
                <button type="button" class="btn-close" onclick="closeModal()">√ó</button>
            </div>

            <form id="socioForm">
                <!-- 1. Identificaci√≥n b√°sica de todos los integrantes de la familia -->
                <h3 style="margin-top: 1rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                    1. Identificaci√≥n de los Integrantes de la Familia
                </h3>

                <div class="form-group">
                    <label class="form-label required">N√∫mero de miembros de la familia</label>
                    <input type="number" id="modalNumMiembros" class="form-input" min="1" value="1" required>
                    <small class="form-help">Incluy√©ndote a ti</small>
                </div>

                <div id="modalMiembrosContainer"></div>

                <!-- 2. Datos de contacto -->
                <h3 style="margin-top: 2rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                    2. Datos de Contacto
                </h3>

                <div class="form-group">
                    <label class="form-label required">Tel√©fono</label>
                    <input type="tel" id="modalTelefono" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label required">Correo electr√≥nico</label>
                    <input type="email" id="modalEmail" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Contacto de emergencia (opcional)</label>
                    <input type="text" id="modalContactoEmergencia" class="form-input" placeholder="Nombre y tel√©fono">
                    <small class="form-help">Nombre completo y n√∫mero de tel√©fono de una persona de contacto en caso de emergencia</small>
                </div>

                <!-- 3. Situaci√≥n del socio en la cooperativa -->
                <h3 style="margin-top: 2rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                    3. Situaci√≥n del Socio en la Cooperativa
                </h3>

                <div class="form-group">
                    <label class="form-label required">Fecha de ingreso</label>
                    <input type="date" id="modalFechaIngreso" class="form-input" required>
                    <small class="form-help">Fecha en que te unes a la cooperativa</small>
                </div>

                <div class="form-group">
                    <label class="form-label">Estado</label>
                    <select id="modalEstado" class="form-select" required>
                        <option value="Activo">Activo</option>
                        <option value="Inactivo">Inactivo</option>
                    </select>
                </div>

                <!-- 4. Aportaciones y obligaciones -->
                <h3 style="margin-top: 2rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                    4. Aportaciones y Obligaciones
                </h3>

                <div class="form-group">
                    <label class="form-label required">Cuota mensual (‚Ç¨)</label>
                    <input type="number" id="modalCuotaMensual" class="form-input" min="0" step="0.01" value="5" required>
                    <small class="form-help">Aporte mensual a la cooperativa (ejemplo: 5 ‚Ç¨)</small>
                </div>

                <!-- 5. Autorizaciones legales -->
                <h3 style="margin-top: 2rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                    5. Autorizaciones Legales
                </h3>

                <div class="form-group">
                    <label style="display: flex; align-items: start; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" id="modalConsentimientoDatos" class="form-checkbox" required>
                        <span class="form-label">Consentimiento para uso interno de datos</span>
                    </label>
                    <small class="form-help">Acepto que mis datos sean utilizados √∫nicamente para fines internos de la cooperativa, cumpliendo con la normativa de protecci√≥n de datos.</small>
                </div>

                <div class="form-group">
                    <label style="display: flex; align-items: start; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" id="modalAceptacionNormas" class="form-checkbox" required>
                        <span class="form-label">Aceptaci√≥n de normas internas y r√©gimen disciplinario</span>
                    </label>
                    <small class="form-help">Acepto las normas internas de la cooperativa y el r√©gimen disciplinario establecido.</small>
                </div>

                <!-- 6. Participaci√≥n y disponibilidad -->
                <h3 style="margin-top: 2rem; margin-bottom: 1rem; color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem;">
                    6. Participaci√≥n y Disponibilidad
                </h3>

                <div class="form-group">
                    <label class="form-label">√Åreas donde desea colaborar</label>
                    <select id="modalAreasColaboracion" class="form-select" multiple style="min-height: 100px;">
                        <option value="administracion">Administraci√≥n</option>
                        <option value="eventos">Eventos</option>
                        <option value="apoyo_social">Apoyo Social</option>
                        <option value="comunicacion">Comunicaci√≥n</option>
                        <option value="finanzas">Finanzas</option>
                        <option value="proyectos">Proyectos</option>
                    </select>
                    <small class="form-help">Mant√©n presionada la tecla Ctrl (Cmd en Mac) para seleccionar m√∫ltiples opciones</small>
                </div>

                <div class="form-group">
                    <label class="form-label">Otras √°reas (especificar)</label>
                    <input type="text" id="modalOtrasAreas" class="form-input" placeholder="Especifica otras √°reas donde te gustar√≠a colaborar">
                </div>

                <div class="form-group">
                    <label class="form-label required">Disponibilidad aproximada</label>
                    <input type="number" id="modalDisponibilidadHoras" class="form-input" min="0" step="1" value="0" required>
                    <small class="form-help">Horas por mes que puedes dedicar a la cooperativa</small>
                </div>

                <div class="form-actions" style="margin-top: 2rem;">
                    <button type="submit" class="btn btn-primary" id="submitSocioBtn">Guardar</button>
                    <button type="button" class="btn btn-outline" id="cancelModalBtn">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Ver Detalles Completos del Socio -->
    <div id="socioDetallesModal" class="modal hidden">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 class="modal-title">Detalles del Socio</h2>
                <button type="button" class="btn-close" onclick="window.closeSocioDetallesModal();">√ó</button>
            </div>
            <div id="socioDetallesContent" style="padding: 1.5rem;">
                <!-- Contenido se llenar√° din√°micamente -->
            </div>
        </div>
    </div>

    <!-- Modal: Agregar/Editar Gasto -->
    <div id="gastoModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="gastoModalTitle" class="modal-title">Agregar Gasto</h2>
                <button type="button" class="btn-close" onclick="closeGastoModal()">√ó</button>
            </div>

            <form id="gastoForm">
                <div class="form-group">
                    <label class="form-label">Fecha</label>
                    <input type="date" id="gastoFecha" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Concepto</label>
                    <input type="text" id="gastoConcepto" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Monto (‚Ç¨)</label>
                    <input type="number" id="gastoMonto" class="form-input" min="0" step="0.01" required>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Guardar</button>
                    <button type="button" class="btn btn-outline" onclick="closeGastoModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Agregar/Editar Ingreso -->
    <div id="ingresoModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="ingresoModalTitle" class="modal-title">Agregar Ingreso</h2>
                <button type="button" class="btn-close" onclick="closeIngresoModal()">√ó</button>
            </div>

            <form id="ingresoForm">
                <div class="form-group">
                    <label class="form-label">Tipo de Ingreso</label>
                    <select id="ingresoTipo" class="form-select" required onchange="if(typeof window.handleCambioTipoIngreso==='function'){window.handleCambioTipoIngreso();}">
                        <option value="otro">Otro Ingreso</option>
                        <option value="aporte_socio">Aporte de Socio</option>
                    </select>
                </div>

                <div class="form-group" id="ingresoSocioGroup" style="display: none;">
                    <label class="form-label">Socio</label>
                    <select id="ingresoSocioId" class="form-select">
                        <option value="">-- Seleccione un socio --</option>
                    </select>
                    <small class="form-help">Al seleccionar un socio, el concepto y monto se llenar√°n autom√°ticamente con su cuota mensual</small>
                </div>

                <div class="form-group">
                    <label class="form-label">Fecha</label>
                    <input type="date" id="ingresoFecha" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Concepto</label>
                    <input type="text" id="ingresoConcepto" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Monto (‚Ç¨)</label>
                    <input type="number" id="ingresoMonto" class="form-input" min="0" step="0.01" required>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Guardar</button>
                    <button type="button" class="btn btn-outline" onclick="closeIngresoModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Agregar/Editar Pago -->
    <div id="pagoModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="pagoModalTitle" class="modal-title">Registrar Pago</h2>
                <button type="button" class="btn-close" onclick="closePagoModal()">√ó</button>
            </div>

            <form id="pagoForm">
                <div class="form-group">
                    <label class="form-label">Socio</label>
                    <select id="pagoSocioId" class="form-select" required>
                        <option value="">-- Seleccione un socio --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Fecha</label>
                    <input type="date" id="pagoFecha" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Monto (‚Ç¨)</label>
                    <input type="number" id="pagoMonto" class="form-input" min="0" step="0.01" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Concepto</label>
                    <input type="text" id="pagoConcepto" class="form-input" required>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Guardar</button>
                    <button type="button" class="btn btn-outline" onclick="closePagoModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>Cooperativa ProVivienda - Versi√≥n 1.0.0</p>
    </footer>

  <!-- Scripts -->
    <!-- Script de respaldo para capturar errores -->
    <script>
        // Capturar errores de JavaScript globalmente
        window.addEventListener('error', function(e) {
            console.error('Error global capturado:', e.error);
            console.error('En:', e.filename, 'l√≠nea', e.lineno);
        });

        // Capturar errores de promesas rechazadas
        window.addEventListener('unhandledrejection', function(e) {
            console.error('Promesa rechazada sin manejar:', e.reason);
        });

        console.log('‚úÖ Script de respaldo cargado');
        
        // Verificar carga de scripts despu√©s de un delay
        window.addEventListener('load', function() {
            setTimeout(function() {
                console.log('üîç Verificando funciones disponibles...');
                const functions = [
                    'openAddModal', 
                    'openAddGastoModal', 
                    'openAddIngresoModal', 
                    'openAddPagoModal',
                    'switchTab',
                    'switchAdminTab'
                ];
                
                functions.forEach(function(fnName) {
                    if (typeof window[fnName] === 'function') {
                        console.log('‚úÖ ' + fnName + ' est√° disponible');
                    } else {
                        console.error('‚ùå ' + fnName + ' NO est√° disponible');
                    }
                });
            }, 1000);
        });
    </script>
    
    <!-- Scripts en orden: primero db.js, luego admin-panel.js, finalmente main.js -->
    <script src="js/database.js"></script>
    <script src="js/db.js"></script>
    <script src="js/admin-panel.js"></script>
    <script src="js/main.js"></script>
    
    <!-- Script para generar QR cuando la p√°gina est√© lista -->
    <script>
        window.addEventListener('load', function() {
            setTimeout(function() {
                if (typeof window.generateQRCode === 'function') {
                    window.generateQRCode();
                }
            }, 500);
        });
    </script>
    
    <!-- Script de verificaci√≥n final y reconexi√≥n forzada -->
    <script>
        // Funci√≥n para reconectar todos los botones
        function reconectarBotones() {
            console.log('üîß Reconectando botones...');
            
            // Bot√≥n Agregar Socio
            const addSocioBtn = document.getElementById('addSocioBtn');
            if (addSocioBtn) {
                // Remover listeners anteriores
                addSocioBtn.onclick = null;
                const newBtn = addSocioBtn.cloneNode(true);
                addSocioBtn.parentNode.replaceChild(newBtn, addSocioBtn);
                
                // Agregar nuevo listener
                document.getElementById('addSocioBtn').addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ Click detectado en Agregar Socio');
                    if (typeof window.openAddModal === 'function') {
                        window.openAddModal();
                    } else {
                        alert('Funci√≥n no disponible. Por favor recarga la p√°gina.');
                    }
                });
                console.log('‚úÖ Bot√≥n Agregar Socio reconectado');
            }
            
            // Bot√≥n Agregar Gasto
            const addGastoBtn = document.getElementById('addGastoBtn');
            if (addGastoBtn) {
                addGastoBtn.onclick = null;
                addGastoBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ Click detectado en Agregar Gasto');
                    if (typeof window.openAddGastoModal === 'function') {
                        window.openAddGastoModal();
                    } else {
                        alert('Funci√≥n no disponible. Por favor recarga la p√°gina.');
                    }
                });
                console.log('‚úÖ Bot√≥n Agregar Gasto reconectado');
            }
            
            // Bot√≥n Agregar Ingreso
            const addIngresoBtn = document.getElementById('addIngresoBtn');
            if (addIngresoBtn) {
                addIngresoBtn.onclick = null;
                addIngresoBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ Click detectado en Agregar Ingreso');
                    if (typeof window.openAddIngresoModal === 'function') {
                        window.openAddIngresoModal();
                    } else {
                        alert('Funci√≥n no disponible. Por favor recarga la p√°gina.');
                    }
                });
                console.log('‚úÖ Bot√≥n Agregar Ingreso reconectado');
            }
            
            // Bot√≥n Registrar Pago
            const addPagoBtn = document.getElementById('addPagoBtn');
            if (addPagoBtn) {
                addPagoBtn.onclick = null;
                addPagoBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ Click detectado en Registrar Pago');
                    if (typeof window.openAddPagoModal === 'function') {
                        window.openAddPagoModal();
                    } else {
                        alert('Funci√≥n no disponible. Por favor recarga la p√°gina.');
                    }
                });
                console.log('‚úÖ Bot√≥n Registrar Pago reconectado');
            }
            
            // Botones de tabs
            const tabSocios = document.getElementById('tabSocios');
            if (tabSocios) {
                tabSocios.onclick = null;
                tabSocios.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (typeof window.switchTab === 'function') {
                        window.switchTab('socios');
                    }
                });
            }
            
            const tabAdmin = document.getElementById('tabAdmin');
            if (tabAdmin) {
                tabAdmin.onclick = null;
                tabAdmin.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (typeof window.switchTab === 'function') {
                        window.switchTab('admin');
                    }
                });
            }
        }
        
        // Ejecutar cuando la p√°gina cargue completamente
        window.addEventListener('load', function() {
            console.log('üìÑ P√°gina completamente cargada');
            
            // Esperar un poco para que todos los scripts carguen
            setTimeout(function() {
                console.log('üîç Verificando funciones disponibles...');
                const functions = [
                    'openAddModal', 
                    'openAddGastoModal', 
                    'openAddIngresoModal', 
                    'openAddPagoModal',
                    'switchTab',
                    'switchAdminTab'
                ];
                
                functions.forEach(function(fnName) {
                    if (typeof window[fnName] === 'function') {
                        console.log('‚úÖ ' + fnName + ' est√° disponible');
                    } else {
                        console.error('‚ùå ' + fnName + ' NO est√° disponible');
                    }
                });
                
                // Reconectar botones despu√©s de verificar
                reconectarBotones();
                
                // Actualizar balance y conteo de socios
                if (typeof window.updateBalanceDisplay === 'function') {
                    window.updateBalanceDisplay().catch(err => console.error('Error actualizando balance:', err));
                }
            }, 500);
        });
    </script>
</body>
</html>
